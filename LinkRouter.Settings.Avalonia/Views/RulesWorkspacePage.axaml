<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:fa="using:FluentAvalonia.UI.Controls"
             x:Class="LinkRouter.Settings.Avalonia.Views.RulesWorkspacePage">
    <ScrollViewer>
        <StackPanel Margin="24" Spacing="16">
            <TextBlock Text="Rules" FontSize="20" FontWeight="SemiBold" />
            <Grid ColumnDefinitions="2*,3*" ColumnSpacing="16" RowSpacing="16">
                <Border Classes="SettingsCard">
                    <StackPanel Spacing="12">
                        <TextBlock Text="Configured rules" Classes="CardTitle" />
                        <TextBlock Text="Add, duplicate, or reorder link rules." Classes="CardDescription" />
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <Button Content="Add" Command="{Binding AddRuleCommand}" />
                            <Button Content="Duplicate" Command="{Binding DuplicateRuleCommand}" CommandParameter="{Binding SelectedRule}" />
                            <Button Content="Delete" Command="{Binding DeleteRuleCommand}" CommandParameter="{Binding SelectedRule}" />
                            <Button Content="Move Up" Command="{Binding MoveUpCommand}" CommandParameter="{Binding SelectedRule}" />
                            <Button Content="Move Down" Command="{Binding MoveDownCommand}" CommandParameter="{Binding SelectedRule}" />
                        </StackPanel>
                        <ListBox ItemsSource="{Binding Rules}"
                                 SelectedItem="{Binding SelectedRule, Mode=TwoWay}"
                                 MinHeight="300">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding DisplayName}" />
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </StackPanel>
                </Border>

                <Border Grid.Column="1" Classes="SettingsCard">
                    <ScrollViewer MaxHeight="520">
                        <StackPanel Spacing="16">
                            <TextBlock Text="Rule details" Classes="CardTitle" />
                            <TextBlock Text="Adjust the selected rule and open the advanced editor." Classes="CardDescription" />

                            <StackPanel Spacing="4">
                                <TextBlock Text="Summary" FontWeight="SemiBold" />
                                <TextBlock Text="{Binding SelectedRule.DisplayName, FallbackValue=Select a rule, TargetNullValue=Select a rule}" TextWrapping="Wrap" />
                            </StackPanel>

                            <ToggleSwitch Content="Enabled"
                                          IsChecked="{Binding SelectedRule.Enabled, Mode=TwoWay}" />

                            <StackPanel Spacing="4">
                                <TextBlock Text="Match" />
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <ComboBox ItemsSource="{Binding MatchTypes}"
                                              SelectedItem="{Binding SelectedRule.Match, Mode=TwoWay}"
                                              Width="140" />
                                    <TextBox Text="{Binding SelectedRule.Pattern, Mode=TwoWay}"
                                             Width="220"
                                             Watermark="Pattern" />
                                </StackPanel>
                            </StackPanel>

                            <StackPanel Spacing="4">
                                <TextBlock Text="Use Profile" />
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <ComboBox ItemsSource="{Binding ProfileOptions}"
                                              SelectedItem="{Binding SelectedRule.UseProfile, Mode=TwoWay}"
                                              Width="200"
                                              PlaceholderText="Select a configured profile" />
                                    <Button Content="Clear"
                                            Command="{Binding ClearUseProfileCommand}" />
                                </StackPanel>
                            </StackPanel>

                            <Button Content="Open full editor"
                                    HorizontalAlignment="Left"
                                    Command="{Binding EditRuleCommand}" />

                            <Separator />

                            <StackPanel Spacing="8">
                                <TextBlock Text="Test URL" />
                                <TextBox Text="{Binding TestUrl, Mode=TwoWay}" />
                                <Button Content="Test Rule" Command="{Binding TestRuleCommand}" />
                                <TextBlock Text="{Binding TestResult}" TextWrapping="Wrap" />
                                <TextBlock Text="{Binding TestError}" TextWrapping="Wrap" Classes="ValidationErrorText" />
                            </StackPanel>
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </Grid>
        </StackPanel>
    </ScrollViewer>
</UserControl>
